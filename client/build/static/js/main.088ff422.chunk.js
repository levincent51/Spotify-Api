(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{46:function(e,t,c){},47:function(e,t,c){},48:function(e,t,c){},76:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),s=c(26),a=c.n(s),i=(c(46),c(47),c(48),c(1));function o(){return Object(i.jsxs)("div",{className:"login",children:[Object(i.jsx)("p",{children:"An insight into your listening habits on Spotify"}),Object(i.jsx)("a",{href:"https://react-express-spotify.herokuapp.com/login",children:" Login to Spotify "})]})}var l=c(9),j=c(2),d=c(8);function b(e){var t=Math.floor(e/6e4),c=(e%6e4/1e3).toFixed(0);return t+":"+(c<10?"0":"")+c}var h=function(){window.localStorage.clear(),window.location.replace("/");var e=Object(n.useState)(!1),t=Object(d.a)(e,2),c=t[0],r=t[1];return c?Object(i.jsx)(Redirect,{to:"/",push:!0}):Object(i.jsx)(Button,{onClick:function(){localStorage.removeItem("whpf_user"),r(!0)},children:"LogOut"})},u=function(){return Object(i.jsxs)("div",{className:"navbar",children:[Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/",children:"HOME"})}),Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/TopTracks",activeStyle:{fontWeight:"bold",color:"green"},children:"Top Tracks"})}),Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/RecentTracks",activeStyle:{fontWeight:"bold",color:"green"},children:"RecentlyPlayed"})}),Object(i.jsx)("li",{style:{float:"right"},children:Object(i.jsx)(l.b,{to:"/logout",children:"Logout"})})]})},O=c(14),x=c.n(O),m=c(29),f=c(30),p=c.n(f),k=c(31),g=new(c.n(k).a),v=function(){var e=Object(m.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.localStorage.getItem("refresh_token"),p.a.get("https://react-express-spotify.herokuapp.com/refresh_token",{params:{refresh_token:t}}).then((function(e){var t=e.data.access_token;console.log("New acccess_token",t),window.localStorage.setItem("access_token",t),window.localStorage.setItem("token_timestamp",Date.now()),window.location.reload()})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=function(){var e,t={},c=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=c.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=c.exec(n);return t}(),t=e.error,c=e.access_token,n=e.refresh_token;if(t&&(console.log(t),v()),c&&n)return window.location.replace("/"),window.localStorage.setItem("access_token",c),window.localStorage.setItem("refresh_token",n),window.localStorage.setItem("token_timestamp",Date.now()),c;var r=window.localStorage.getItem("token_timestamp");return r&&"undefined"!==r&&Date.now()-r>36e5&&(console.log("Token expired, refreshing token"),v()),window.localStorage.getItem("access_token")},y=w();g.setAccessToken(y);var N=function(e){var t=e.track;return Object(i.jsx)("a",{className:"TrackInfoLink",href:t.uri,children:Object(i.jsxs)("div",{className:"card",children:[Object(i.jsx)("img",{src:t.album.images[1].url,alt:"Track"}),Object(i.jsxs)("div",{className:"containerCard",children:[Object(i.jsx)("h4",{children:Object(i.jsx)("b",{children:t.artists.map((function(e){return e.name})).join(", ")})}),Object(i.jsx)("p",{children:t.name})]})]})})},_=function(){var e=Object(n.useState)(1),t=Object(d.a)(e,2),c=t[0],r=t[1],s=Object(n.useState)(),a=Object(d.a)(s,2),o=a[0],l=a[1],j=Object(n.useState)("short_term"),b=Object(d.a)(j,2),h=b[0],u=b[1],O=function(e,t){var c;c=t,l(),u(c),r(e)};return Object(n.useEffect)((function(){g.getMyTopTracks({limit:50,time_range:h}).then((function(e){e&&(console.log(e),l({items:e.items}))})).catch((function(){w()}))}),[h]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:"Top Tracks"}),Object(i.jsxs)("div",{className:"container",children:[Object(i.jsxs)("div",{className:"bloc-tabs",children:[Object(i.jsx)("button",{className:1===c?"tabs active-tabs":"tabs",onClick:function(){return O(1,"short_term")},children:"4 weeks"}),Object(i.jsx)("button",{className:2===c?"tabs active-tabs":"tabs",onClick:function(){return O(2,"medium_term")},children:"6 months"}),Object(i.jsx)("button",{className:3===c?"tabs active-tabs":"tabs",onClick:function(){return O(3,"long_term")},children:"All time"})]}),o?Object(i.jsxs)("div",{className:"content-tabs",children:[Object(i.jsx)("div",{className:1===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))}),Object(i.jsx)("div",{className:2===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))}),Object(i.jsx)("div",{className:3===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))})]}):Object(i.jsx)("b",{children:"LOADING"})]})]})},S=c(40),T=function(){var e=Object(n.useState)(),t=Object(d.a)(e,2),c=t[0],r=t[1];return Object(n.useEffect)((function(){g.getMyRecentlyPlayedTracks({limit:50}).then((function(e){e&&(console.log(e),r({items:e.items}))})).catch((function(){w()}))}),[]),console.log(c),Object(i.jsx)("div",{children:c?Object(i.jsxs)("div",{className:"recently-played",children:[Object(i.jsx)("h2",{children:"Recently played tracks"}),Object(i.jsxs)("table",{className:"table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Duration"}),Object(i.jsx)("th",{children:"Track"}),Object(i.jsx)("th",{children:"Artist(s)"}),Object(i.jsx)("th",{children:"Played at"})]})}),Object(i.jsx)("tbody",{children:c.items.map((function(e){return function(e){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,className:"row-link",children:b(e.track.duration_ms)})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:e.track.name})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:e.track.artists.map((function(e){return e.name})).join(", ")})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:Object(S.a)(Date.parse(e.played_at),"dd/MM/yyyy, hh:mma")})})]},e.played_at)}(e)}))})]})]}):Object(i.jsx)("b",{children:"LOADING"})})};c(75);function I(){return Object(i.jsx)(l.a,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)(u,{}),Object(i.jsxs)(j.c,{children:[Object(i.jsx)(j.a,{path:"/RecentTracks",children:Object(i.jsx)(T,{})}),Object(i.jsx)(j.a,{path:"/logout",children:Object(i.jsx)(h,{})}),Object(i.jsx)(j.a,{path:"/TopTracks",children:Object(i.jsx)(_,{})}),Object(i.jsx)(j.a,{path:"/",children:Object(i.jsx)("h1",{children:"WELCOME TO SPOTIFY API"})})]})]})})}var A=function(){return Object(i.jsx)("div",{className:"App",children:y?Object(i.jsx)(I,{}):Object(i.jsx)(o,{})})};a.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(A,{})}),document.getElementById("root"))}},[[76,1,2]]]);
//# sourceMappingURL=main.088ff422.chunk.js.map