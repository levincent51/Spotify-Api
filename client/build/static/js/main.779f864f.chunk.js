(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{50:function(e,t,c){},51:function(e,t,c){},52:function(e,t,c){},80:function(e,t,c){"use strict";c.r(t);var n=c(0),r=c.n(n),a=c(31),s=c.n(a),i=(c(50),c(51),c(52),c(1));function o(){return Object(i.jsxs)("div",{className:"login",children:[Object(i.jsx)("p",{children:"An insight into your listening habits on Spotify"}),Object(i.jsx)("a",{href:"https://react-express-spotify.herokuapp.com/login",children:" Login to Spotify "})]})}var l=c(12),j=c(3),u=c(11);function b(e){var t=Math.floor(e/6e4),c=(e%6e4/1e3).toFixed(0);return t+":"+(c<10?"0":"")+c}var d=function(){window.localStorage.clear(),window.location.replace("/");var e=Object(n.useState)(!1),t=Object(u.a)(e,2),c=t[0],r=t[1];return c?Object(i.jsx)(Redirect,{to:"/",push:!0}):Object(i.jsx)(Button,{onClick:function(){localStorage.removeItem("whpf_user"),r(!0)},children:"LogOut"})},h=function(){return Object(i.jsxs)("div",{className:"navbar",children:[Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/",children:"HOME"})}),Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/TopTracks",activeStyle:{fontWeight:"bold",color:"green"},children:"Top Tracks"})}),Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/RecentTracks",activeStyle:{fontWeight:"bold",color:"green"},children:"RecentlyPlayed"})}),Object(i.jsx)("li",{children:Object(i.jsx)(l.b,{to:"/Recommendations",activeStyle:{fontWeight:"bold",color:"green"},children:"Recommendations"})}),Object(i.jsx)("li",{style:{float:"right"},children:Object(i.jsx)(l.b,{to:"/logout",children:"Logout"})})]})},O=c(2),f=c.n(O),x=c(4),m=c(34),p=c.n(m),v=c(35),k=new(c.n(v).a),g=function(){var e=Object(x.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=window.localStorage.getItem("refresh_token"),p.a.get("https://react-express-spotify.herokuapp.com/refresh_token",{params:{refresh_token:t}}).then((function(e){var t=e.data.access_token;console.log("New acccess_token",t),window.localStorage.setItem("access_token",t),window.localStorage.setItem("token_timestamp",Date.now()),window.location.reload()})).catch((function(e){return console.log(e)}));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=function(){var e,t={},c=/([^&;=]+)=?([^&;]*)/g,n=window.location.hash.substring(1);for(e=c.exec(n);e;)t[e[1]]=decodeURIComponent(e[2]),e=c.exec(n);return t}(),t=e.error,c=e.access_token,n=e.refresh_token;if(t&&(console.log(t),g()),c&&n)return window.location.replace("/"),window.localStorage.setItem("access_token",c),window.localStorage.setItem("refresh_token",n),window.localStorage.setItem("token_timestamp",Date.now()),c;var r=window.localStorage.getItem("token_timestamp");return r&&"undefined"!==r&&Date.now()-r>36e5&&(console.log("Token expired, refreshing token"),g()),window.localStorage.getItem("access_token")},y=w();k.setAccessToken(y);var N=function(e){var t=e.track;return Object(i.jsx)("a",{className:"TrackInfoLink",href:t.uri,children:Object(i.jsxs)("div",{className:"card",children:[Object(i.jsx)("img",{src:t.album.images[1].url,alt:"Track"}),Object(i.jsxs)("div",{className:"containerCard",children:[Object(i.jsx)("h4",{children:Object(i.jsx)("b",{children:t.artists.map((function(e){return e.name})).join(", ")})}),Object(i.jsx)("p",{children:t.name})]})]})})},S=function(){var e=Object(n.useState)(1),t=Object(u.a)(e,2),c=t[0],r=t[1],a=Object(n.useState)(),s=Object(u.a)(a,2),o=s[0],l=s[1],j=Object(n.useState)("short_term"),b=Object(u.a)(j,2),d=b[0],h=b[1],O=function(e,t){var c;c=t,l(),h(c),r(e)};return Object(n.useEffect)((function(){k.getMyTopTracks({limit:50,time_range:d}).then((function(e){e&&(console.log(e),l({items:e.items}))})).catch((function(){w()}))}),[d]),Object(i.jsxs)("div",{children:[Object(i.jsx)("h2",{children:"Top Tracks"}),Object(i.jsxs)("div",{className:"container",children:[Object(i.jsxs)("div",{className:"bloc-tabs",children:[Object(i.jsx)("button",{className:1===c?"tabs active-tabs":"tabs",onClick:function(){return O(1,"short_term")},children:"4 weeks"}),Object(i.jsx)("button",{className:2===c?"tabs active-tabs":"tabs",onClick:function(){return O(2,"medium_term")},children:"6 months"}),Object(i.jsx)("button",{className:3===c?"tabs active-tabs":"tabs",onClick:function(){return O(3,"long_term")},children:"All time"})]}),o?Object(i.jsxs)("div",{className:"content-tabs",children:[Object(i.jsx)("div",{className:1===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))}),Object(i.jsx)("div",{className:2===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))}),Object(i.jsx)("div",{className:3===c?"content  active-content":"content",children:o.items.map((function(e,t){return Object(i.jsx)(N,{track:e},t)}))})]}):Object(i.jsx)("b",{children:"LOADING"})]})]})},_=c(17),T=c(7);var I=function(){var e=Object(x.a)(f.a.mark((function e(t,c,n){var r,a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n+c,e.next=3,k.getUserPlaylists({limit:c,offset:n}).then((function(e){e&&(a=[].concat(Object(T.a)(t),Object(T.a)(e.items)),e.next&&(a=I(a,c,r)))})).catch((function(){w()}));case 3:return e.abrupt("return",a);case 4:case"end":return e.stop()}}),e)})));return function(t,c,n){return e.apply(this,arguments)}}(),R=function(){var e=Object(x.a)(f.a.mark((function e(t,c,n,r){var a,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r+n,e.next=3,k.getPlaylistTracks(y,t,{limit:n,offset:r}).then((function(e){e&&(s=[].concat(Object(T.a)(c),Object(T.a)(e.items)),e.next&&(s=R(t,s,n,a)))}));case 3:return e.abrupt("return",s);case 4:case"end":return e.stop()}}),e)})));return function(t,c,n,r){return e.apply(this,arguments)}}(),C=function(){var e=Object(x.a)(f.a.mark((function e(t){var c;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t,[],100,0).then((function(e){if(e)return e.map((function(e){return e.track.id}))}));case 2:return c=e.sent,e.abrupt("return",c);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),c=t[0],r=t[1],a=Object(n.useState)(),s=Object(u.a)(a,2),o=s[0],l=s[1];Object(n.useEffect)((function(){function e(){return(e=Object(x.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I([],50,0).then(function(){var e=Object(x.a)(f.a.mark((function e(t){var c,n,a,s;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=[],n=Object(_.a)(t.map((function(e){return e.id}))),e.prev=2,n.s();case 4:if((a=n.n()).done){e.next=16;break}return s=a.value,e.t0=[],e.t1=Object(T.a)(c),e.t2=T.a,e.next=11,C(s);case 11:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),c=e.t0.concat.call(e.t0,e.t1,e.t4);case 14:e.next=4;break;case 16:e.next=21;break;case 18:e.prev=18,e.t5=e.catch(2),n.e(e.t5);case 21:return e.prev=21,n.f(),e.finish(21);case 24:r(c);case 25:case"end":return e.stop()}}),e,null,[[2,18,21,24]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),console.log(c),Object(n.useEffect)((function(){c&&(l(1),console.log("hiii"))}),[c]);var j=Object(n.useState)(1),b=Object(u.a)(j,2),d=b[0],h=b[1],O=function(e,t){h(e)};return Object(i.jsx)("div",{children:o?Object(i.jsx)("div",{className:"container",children:Object(i.jsxs)("div",{className:"bloc-tabs",children:[Object(i.jsx)("button",{className:1===d?"tabs active-tabs":"tabs",onClick:function(){return O(1)},children:"Sad"}),Object(i.jsx)("button",{className:2===d?"tabs active-tabs":"tabs",onClick:function(){return O(2)},children:"Happy"}),Object(i.jsx)("button",{className:3===d?"tabs active-tabs":"tabs",onClick:function(){return O(3)},children:"Study"})]})}):Object(i.jsx)("b",{children:"loading"})})},D=c(44),M=function(){var e=Object(n.useState)(),t=Object(u.a)(e,2),c=t[0],r=t[1];return Object(n.useEffect)((function(){k.getMyRecentlyPlayedTracks({limit:50}).then((function(e){e&&(console.log(e),r({items:e.items}))})).catch((function(){w()}))}),[]),console.log(c),Object(i.jsx)("div",{children:c?Object(i.jsxs)("div",{className:"recently-played",children:[Object(i.jsx)("h2",{children:"Recently played tracks"}),Object(i.jsxs)("table",{className:"table",children:[Object(i.jsx)("thead",{children:Object(i.jsxs)("tr",{children:[Object(i.jsx)("th",{children:"Duration"}),Object(i.jsx)("th",{children:"Track"}),Object(i.jsx)("th",{children:"Artist(s)"}),Object(i.jsx)("th",{children:"Played at"})]})}),Object(i.jsx)("tbody",{children:c.items.map((function(e){return function(e){return Object(i.jsxs)("tr",{children:[Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,className:"row-link",children:b(e.track.duration_ms)})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:e.track.name})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:e.track.artists.map((function(e){return e.name})).join(", ")})}),Object(i.jsx)("td",{children:Object(i.jsx)("a",{href:e.track.uri,tabIndex:"-1",className:"row-link",children:Object(D.a)(Date.parse(e.played_at),"dd/MM/yyyy, hh:mma")})})]},e.played_at)}(e)}))})]})]}):Object(i.jsx)("b",{children:"LOADING"})})};c(79);function E(){return Object(i.jsx)(l.a,{children:Object(i.jsxs)("div",{children:[Object(i.jsx)(h,{}),Object(i.jsxs)(j.c,{children:[Object(i.jsx)(j.a,{path:"/RecentTracks",children:Object(i.jsx)(M,{})}),Object(i.jsx)(j.a,{path:"/logout",children:Object(i.jsx)(d,{})}),Object(i.jsx)(j.a,{path:"/TopTracks",children:Object(i.jsx)(S,{})}),Object(i.jsx)(j.a,{path:"/Recommendations",children:Object(i.jsx)(A,{})}),Object(i.jsx)(j.a,{path:"/",children:Object(i.jsx)("h1",{children:"Welcome to Spoti-FYI"})})]})]})})}var L=function(){return Object(i.jsx)("div",{className:"App",children:y?Object(i.jsx)(E,{}):Object(i.jsx)(o,{})})};s.a.render(Object(i.jsx)(r.a.StrictMode,{children:Object(i.jsx)(L,{})}),document.getElementById("root"))}},[[80,1,2]]]);
//# sourceMappingURL=main.779f864f.chunk.js.map